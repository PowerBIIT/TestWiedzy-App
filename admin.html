<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel Administracyjny Quizu</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container py-4">
        <header class="mb-4 text-center">
            <h1>Panel Administracyjny Quizu</h1>
            <p class="lead">Ustaw parametry quizu i zarządzaj pytaniami</p>
        </header>
        
        <!-- Uproszczony formularz konfiguracji -->
        <div class="card mb-4">
            <div class="card-header bg-primary text-white">
                <h2 class="h5 mb-0">Konfiguracja Quizu</h2>
            </div>
            <div class="card-body">
                <form id="config-form" class="mb-0">
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label for="question-file" class="form-label">Plik z pytaniami</label>
                            <select id="question-file" class="form-select">
                                <option value="Pytania.md">Pytania.md (domyślny)</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label for="question-count" class="form-label">Liczba pytań</label>
                            <input type="number" id="question-count" class="form-control" min="1" max="100" value="20">
                        </div>
                        <div class="col-12 mt-3">
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="shuffle-questions" checked>
                                <label class="form-check-label" for="shuffle-questions">Losowa kolejność pytań</label>
                            </div>
                        </div>
                        <div class="col-12 mt-3">
                            <button type="button" id="save-config" class="btn btn-primary">Zapisz ustawienia</button>
                            <button type="button" id="reset-config" class="btn btn-outline-secondary ms-2">Resetuj do domyślnych</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
        
        <!-- Uproszczone zarządzanie plikami -->
        <div class="card mb-4">
            <div class="card-header bg-success text-white">
                <h2 class="h5 mb-0">Edycja pliku z pytaniami</h2>
            </div>
            <div class="card-body">
                <div class="mb-3">
                    <label for="edit-file-select" class="form-label">Wybierz plik do edycji</label>
                    <select id="edit-file-select" class="form-select">
                        <option value="Pytania.md">Pytania.md (domyślny)</option>
                    </select>
                </div>
                <div class="mb-3">
                    <label for="edit-content" class="form-label">Zawartość pliku</label>
                    <textarea id="edit-content" class="form-control" rows="10" style="font-family: monospace;"></textarea>
                    <div class="form-text">Format: "Pytanie",Odp A,Odp B,Odp C,Odp D,Poprawna odpowiedź (A/B/C/D)</div>
                </div>
                <div class="mb-3 d-flex justify-content-between">
                    <button type="button" id="load-file" class="btn btn-secondary">Wczytaj zawartość</button>
                    <button type="button" id="save-file" class="btn btn-success">Zapisz zmiany</button>
                </div>
                
                <hr class="my-4">
                
                <div class="mb-3">
                    <label for="new-file" class="form-label">Dodaj nowy plik</label>
                    <div class="input-group">
                        <input type="text" id="new-file" class="form-control" placeholder="nazwa_pliku.md">
                        <button type="button" id="create-file" class="btn btn-outline-success">Utwórz</button>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="text-center mb-3">
            <a href="index.html" class="btn btn-primary">
                <i class="bi bi-arrow-left-circle me-2"></i> Wróć do quizu
            </a>
        </div>
    </div>

    <!-- Skrypty -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="config.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Elementy DOM
            const elements = {
                questionFile: document.getElementById('question-file'),
                questionCount: document.getElementById('question-count'),
                shuffleQuestions: document.getElementById('shuffle-questions'),
                saveConfig: document.getElementById('save-config'),
                resetConfig: document.getElementById('reset-config'),
                
                editFileSelect: document.getElementById('edit-file-select'),
                editContent: document.getElementById('edit-content'),
                loadFile: document.getElementById('load-file'),
                saveFile: document.getElementById('save-file'),
                
                newFile: document.getElementById('new-file'),
                createFile: document.getElementById('create-file')
            };
            
            // Wczytaj konfigurację
            function loadConfig() {
                const config = window.quizConfig.getConfig();
                elements.questionFile.value = config.questionFile || 'Pytania.md';
                elements.questionCount.value = config.questionCount || 20;
                elements.shuffleQuestions.checked = !!config.shuffleQuestions;
            }
            
            // Zapisz konfigurację
            elements.saveConfig.addEventListener('click', function() {
                const config = {
                    questionFile: elements.questionFile.value,
                    questionCount: parseInt(elements.questionCount.value, 10),
                    shuffleQuestions: elements.shuffleQuestions.checked
                };
                
                window.quizConfig.updateConfig(config);
                alert('Ustawienia zostały zapisane!');
            });
            
            // Resetuj konfigurację
            elements.resetConfig.addEventListener('click', function() {
                window.quizConfig.resetConfig();
                loadConfig();
                alert('Ustawienia zostały zresetowane do domyślnych.');
            });
            
            // Wczytaj dostępne pliki
            function loadAvailableFiles() {
                // Wyczyść listy select
                elements.questionFile.innerHTML = '';
                elements.editFileSelect.innerHTML = '';
                
                // Pobierz pliki
                const files = window.quizConfig.findAvailableQuestionFiles();
                
                // Dodaj opcje do list
                files.forEach(file => {
                    const opt1 = document.createElement('option');
                    opt1.value = file;
                    opt1.textContent = file;
                    elements.questionFile.appendChild(opt1);
                    
                    const opt2 = document.createElement('option');
                    opt2.value = file;
                    opt2.textContent = file;
                    elements.editFileSelect.appendChild(opt2);
                });
                
                // Ustaw aktualnie wybrany plik
                const config = window.quizConfig.getConfig();
                if (config.questionFile) {
                    elements.questionFile.value = config.questionFile;
                }
            }
            
            // Wczytaj zawartość pliku
            elements.loadFile.addEventListener('click', function() {
                const fileName = elements.editFileSelect.value;
                if (!fileName) return;
                
                const content = localStorage.getItem(`file_${fileName}`);
                if (content) {
                    elements.editContent.value = content;
                } else {
                    alert('Nie udało się wczytać zawartości pliku!');
                }
            });
            
            // Zapisz zawartość pliku
            elements.saveFile.addEventListener('click', function() {
                const fileName = elements.editFileSelect.value;
                const content = elements.editContent.value;
                
                if (!fileName) {
                    alert('Wybierz plik do zapisania!');
                    return;
                }
                
                localStorage.setItem(`file_${fileName}`, content);
                alert(`Plik ${fileName} został zapisany!`);
            });
            
            // Utwórz nowy plik
            elements.createFile.addEventListener('click', function() {
                const fileName = elements.newFile.value.trim();
                
                if (!fileName) {
                    alert('Podaj nazwę pliku!');
                    return;
                }
                
                if (!fileName.endsWith('.md')) {
                    alert('Nazwa pliku musi kończyć się na .md');
                    return;
                }
                
                // Sprawdź, czy plik już istnieje
                if (localStorage.getItem(`file_${fileName}`)) {
                    if (!confirm(`Plik ${fileName} już istnieje. Czy chcesz go zastąpić?`)) {
                        return;
                    }
                }
                
                // Utwórz pusty plik
                localStorage.setItem(`file_${fileName}`, '');
                
                // Odśwież listy plików
                loadAvailableFiles();
                
                // Wybierz nowy plik do edycji
                elements.editFileSelect.value = fileName;
                elements.editContent.value = '';
                elements.newFile.value = '';
                
                alert(`Utworzono nowy plik: ${fileName}`);
            });
            
            // Inicjalizacja
            loadConfig();
            loadAvailableFiles();
        });
    </script>
</body>
</html> 